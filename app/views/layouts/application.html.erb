<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for?(:title) ? yield(:title) : "Untitled" %></title>
    <%= css3buttons_stylesheets %>
    <%= stylesheet_link_tag "application", :media => 'all'%>
    <%= stylesheet_link_tag "button-basics", :media => 'all'%>
    <%= stylesheet_link_tag "global" %>
	<%= javascript_include_tag :defaults, 'jquery.maskedinput.js' %>
	<%= javascript_include_tag :defaults, 'formToWizard.js' %>
	<%= javascript_include_tag :defaults, 'rails_validations' %>
<script src="http://cdn.jquerytools.org/1.2.5/full/jquery.tools.min.js"></script>	
<script src="/javascripts/jquery.maskedinput.js" type="text/javascript"></script> 
   <script type="text/javascript">
   function getAge(birthDate) {
  var now = new Date();

  function isLeap(year) {
    return year % 4 == 0 && (year % 100 != 0 || year % 400 == 0);
  }

  // days since the birthdate    
  var days = Math.floor((now.getTime() - birthDate.getTime())/1000/60/60/24);
  var age = 0;
  // iterate the years
  for (var y = birthDate.getFullYear(); y <= now.getFullYear(); y++){
    var daysInYear = isLeap(y) ? 366 : 365;
    if (days >= daysInYear){
      days -= daysInYear;
      age++;
      // increment the age only if there are available enough days for the year.
    }
  }
  return age;
}
  $(function() {
        $.mask.definitions['~'] = "[+-]";
        $("#age").mask("99");
        $("#date").mask("99/99/9999",{completed:function(){
    var birthDateStr = this.val().replace(/\//g,"");
    parts = birthDateStr.match(/(\d{2})(\d{2})(\d{4})/);
    dateObj = new Date(parts[3], parts[2]-1, parts[1]);
    var age = getAge(dateObj);
         $("#age").val(age);
         $("#age").attr("readonly", "readonly");
        }});
        $("#date1").mask("99/99/9999");
        $("#date2").mask("99/99/9999");
        $("#resp_date").mask("99/99/9999");
        $("#spouse_date").mask("99/99/9999");
        $("#phone").mask("(999) 999-9999");
        $("#pager").mask("(999) 999-9999");
        $("#ph1").mask("(999) 999-9999");
        $("#resp_phone").mask("(999) 999-9999");
        $("#resp_phoneExt").mask("(999) 999-9999? x99999");
        $("#spouse_workph").mask("(999) 999-9999? x99999");
        $("#cellphone").mask("(999) 999-9999");
        $("#phoneExt").mask("(999) 999-9999? x99999");
        $("#iphone").mask("+33 999 999 999");
        $("#tin").mask("99-9999999");
        $("#ssn").mask("999-99-9999");
        $("#insuredssn").mask("999-99-9999");
        $("#resp_ssn").mask("999-99-9999");
        $("#product").mask("a*-999-a999", { placeholder: " " });
        $("#eyescript").mask("~9.99 ~9.99 999");
        $("#po").mask("PO: aaa-999-***");
        $("#pct").mask("99%");
        $("#zip").mask("99999");
        $("#resp_zipo").mask("99999");


        $("input").blur(function() {
            $("#info").html("Unmasked value: " + $(this).mask());
        }).dblclick(function() {
            $(this).unmask();
        });

$("#new_medicalform :input").tooltip({
	// place tooltip on the right edge
	position: "center right",
	// a little tweaking of the position
	offset: [-2, 10],
	// use the built-in fadeIn/fadeOut effect
	effect: "fade",
	// custom opacity setting
	opacity: 0.7
});

    if ($('#same_above_relation').attr("checked")) {
      $('#medicalhistory_spouse_name_2').val($('#medicalhistory_resp_name').val());
      $('#medicalhistory_spouse_name_2').attr("readonly", "readonly");
      $('#spouse_date').val($('#resp_date').val());
      $('#spouse_empl').val($('#resp_empl').val());
      $('#spouse_workph').val($('#resp_phoneExt').val());
      $('#spouse_date').attr("readonly", "readonly");
      $('#spouse_empl').attr("readonly", "readonly");
      $('#spouse_workph').attr("readonly", "readonly");
    }
$('#same_above_relation').change(function () {
    if ($(this).attr("checked")) {
      $('#medicalhistory_spouse_name_2').val($('#medicalhistory_resp_name').val());
      $('#medicalhistory_spouse_name_2').attr("readonly", "readonly");
      $('#spouse_date').val($('#resp_date').val());
      $('#spouse_empl').val($('#resp_empl').val());
      $('#spouse_workph').val($('#resp_phoneExt').val());
      $('#spouse_date').attr("readonly", "readonly");
      $('#spouse_empl').attr("readonly", "readonly");
      $('#spouse_workph').attr("readonly", "readonly");
      
      return;
    }
      $('#medicalhistory_spouse_name_2').removeAttr("readonly");
      $('#spouse_workph').removeAttr("readonly");
      $('#spouse_date').removeAttr("readonly");
      $('#spouse_empl').removeAttr("readonly");
      $('#medicalhistory_spouse_name_2').val("");
      $('#spouse_date').val("");
      $('#spouse_empl').val("");
      $('#spouse_workph').val("");
});

    if ($('#same_above_person').attr("checked")) {
		$('#medicalhistory_resp_name').val($('#medicalhistory_fname').val());
		$('#medicalhistory_resp_name').attr("readonly", "readonly");
		$('#resp_date').val($('#date').val())
		$('#resp_date').attr("readonly", "readonly");
    $('#resp_address').val($('#medicalhistory_address').val());
    $('#resp_address').attr("readonly", "readonly");
    $('#resp_city').val($('#medicalhistory_city').val());
    $('#resp_city').attr("readonly", "readonly");
    $('#resp_state').val($('#medicalhistory_state').val());
    $('#resp_state').attr("readonly", "readonly");
    $('#resp_zipo').val($('#zip').val());
    $('#resp_zipo').attr("readonly", "readonly");
    $('#resp_phone').val($('#phone').val());
    $('#resp_phone').attr("readonly", "readonly");
    $('#resp_phoneExt').val($('#phoneExt').val());
    $('#resp_phoneExt').attr("readonly", "readonly");
    $('#resp_ssn').val($('#ssn').val());
    $('#resp_ssn').attr("readonly", "readonly");
    $('#resp_empl').val($('#medicalhistory_emp').val());
    $('#resp_empl').attr("readonly", "readonly");
    $('#resp_term').val($('#medicalhistory_emp_term').val());
    $('#resp_term').attr("readonly", "readonly");
    $('#resp_occupation').val($('#medicalhistory_occupation').val());
    $('#resp_occupation').attr("readonly", "readonly");
    $('#resp_relation').val("N/A");
    $('#resp_relation').attr("readonly","readonly");
    }

//same as above
$('#same_above_person').change(function () {
    if ($(this).attr("checked")) {
		$('#medicalhistory_resp_name').val($('#medicalhistory_fname').val());
		$('#medicalhistory_resp_name').attr("readonly", "readonly");
		$('#resp_date').val($('#date').val())
		$('#resp_date').attr("readonly", "readonly");
    $('#resp_address').val($('#medicalhistory_address').val());
    $('#resp_address').attr("readonly", "readonly");
    $('#resp_city').val($('#medicalhistory_city').val());
    $('#resp_city').attr("readonly", "readonly");
    $('#resp_state').val($('#medicalhistory_state').val());
    $('#resp_state').attr("readonly", "readonly");
    $('#resp_zipo').val($('#zip').val());
    $('#resp_zipo').attr("readonly", "readonly");
    $('#resp_phone').val($('#phone').val());
    $('#resp_phone').attr("readonly", "readonly");
    $('#resp_phoneExt').val($('#phoneExt').val());
    $('#resp_phoneExt').attr("readonly", "readonly");
    $('#resp_ssn').val($('#ssn').val());
    $('#resp_ssn').attr("readonly", "readonly");
    $('#resp_empl').val($('#medicalhistory_emp').val());
    $('#resp_empl').attr("readonly", "readonly");
    $('#resp_term').val($('#medicalhistory_emp_term').val());
    $('#resp_term').attr("readonly", "readonly");
    $('#resp_occupation').val($('#medicalhistory_occupation').val());
    $('#resp_occupation').attr("readonly", "readonly");
    $('#resp_relation').val("N/A");
    $('#resp_relation').attr("readonly","readonly");
        return;
    }
	//unchecked
	  $('#medicalhistory_resp_name').val("");
	  $('#medicalhistory_resp_name').removeAttr("readonly");
	  $('#resp_date').val("");
	  $('#resp_date').removeAttr("readonly");
    $('#resp_address').val("");
    $('#resp_address').removeAttr("readonly");
    $('#resp_city').removeAttr("readonly");
    $('#resp_state').removeAttr("readonly");
    $('#resp_zipo').removeAttr("readonly");
    $('#resp_phone').removeAttr("readonly");
    $('#resp_phoneExt').removeAttr("readonly");
    $('#resp_ssn').removeAttr("readonly");
    $('#resp_term').removeAttr("readonly");
    $('#resp_occupation').removeAttr("readonly");
    $('#resp_relation').removeAttr("readonly");
    $('#resp_empl').removeAttr("readonly");
    $('#resp_city').val("");
    $('#resp_state').val("");
    $('#resp_zipo').val("");
    $('#resp_phone').val("");
    $('#resp_phoneExt').val("");
    $('#resp_ssn').val("");
    $('#resp_term').val("");
    $('#resp_occupation').val("");
    $('#resp_relation').val("");
});



    });




</script>
    <%= csrf_meta_tag %>
    <%= yield(:head) %>
  </head>
  <body>
<!--<div class="wrapped">
                <div class="column" id="product-nav">
                    <h3>The Bundle</h3>
                    <ul>
                            <li rel="258" class="active"><a href="javascript:void(0)">Loop11</a></li>
                            <li rel="269"><a href="javascript:void(0)">page.ly</a></li>
                            <li rel="280"><a href="javascript:void(0)">WebCollaboration</a></li>
                    </ul>
                    <p><a href="/startup-weekend/buy/">Get the bundle today</a><br>
                </div>
</div>-->
<div id="C_header">
		<div id="C_headerBody">
				<div id="C_userNav">
						<ul id="C_userLinks">
								<li class="C_userNavItem"><a class="J_loginLink J_onClick headerLogin" href="/login/">Log in</a></li>
								<!--<li class="C_userNavItem"><a href="https://secure.meetup.com/register/" class="omnCamp omnrg_signup">Sign up</a></li>-->
						</ul>
				</div>
				<div id="C_globalNav">
						<div id="C_tabs">
								<a href="/medicalhistories/new">
										<span class="C_tabContent">
										  <span class="C_topBig">New Patients</span>
										  <span class="C_topSm">Fill Forms</span>
										</span>
								</a>
								<a href="#" class="omnCamp omnic_sn1" id="tabs_start">
										<span class="C_startContainer C_tabContent">
										  <span class="C_topBig">Appointments</span>
										  <span class="C_topSm">schedule appointments</span>
										</span>
								</a>
								<a href="#" class="omnCamp omnrg_perksheader" >
										<span class="C_startContainer C_tabContent">
										  <span class="C_topBig">Locations</span>
										  <span class="C_topSm">list locations</span>
										</span>
								</a>
						</div>
				</div>
		</div>
</div>

<div id="C_pageBody">
    <div id="container">
      <% flash.each do |name, msg| %>
        <%= content_tag :div, msg, :id => "flash_#{name}" %>
      <% end %>
      <%= content_tag :h1, yield(:title) if show_title? %>
      <%= yield %>
    </div>
</div>


  </body>
</html>
